name: Extract APK Signature

on:
  workflow_dispatch:   # lo lanzas manualmente desde la pestaÃ±a Actions

jobs:
  verify:
    runs-on: ubuntu-latest
    steps:
      - name: Descargar APK desde release
        run: |
          curl -L https://github.com/Jesusdio2/PrivateSignature/releases/download/Dev0/Google.Play.Store.40.0.13-23.0.PR.612537281.apk -o app.apk

      - name: Instalar Android SDK Build Tools
        run: |
          sudo apt-get update
          sudo apt-get install -y unzip openjdk-17-jre-headless
          wget https://dl.google.com/android/repository/build-tools_r34.0.0-linux.zip -O build-tools.zip
          unzip build-tools.zip -d build-tools
          export PATH=$PWD/build-tools/android-13/build-tools/34.0.0:$PATH

      - name: Verificar firma con apksigner y guardar en archivo
        run: |
          ./build-tools/android-13/build-tools/34.0.0/apksigner verify --print-certs app.apk > signature.txt

      - name: Subir artifact con la firma
        uses: actions/upload-artifact@v3
        with:
          name: Extract-APK-Signature
          path: signature.txt
